{% extends 'template.html' %}

{% block content %}

<section class="listings">
	<div class="listings-header">
		<h2>Listings</h2>
		<a class="btn" href="{% url 'create_listing' %}">Create a new listing</a>
	</div>

	{% if listings %}
		<div class="cards">
			{% for l in listings %}
				<article class="card listing-card">
					<h3 class="listing-title">{{ l.title }}</h3>
					<p class="listing-desc">{{ l.description|default:"(no description)" }}</p>
					<div class="listing-meta">
						<span class="author">{{ l.author.username|default:'Anon' }}</span>
						{% if l.price %}<span class="price">${{ l.price }}</span>{% endif %}
					</div>
					<div class="card-actions">
						<a class="btn small" href="{% url 'send_message' l.id %}">Message</a>
						{% if request.user.is_authenticated and request.user == l.author %}
							<a class="btn small danger" href="{% url 'delete_listing' l.id %}">Delete</a>
						{% endif %}
					</div>
				</article>
			{% endfor %}
		</div>
	{% else %}
		<p>No listings yet.</p>
	{% endif %}
</section>

{% endblock %}